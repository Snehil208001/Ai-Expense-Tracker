# Deploy Backend to Render

Deploy the AI Expense Tracker backend to [Render](https://render.com) so you can test the mobile app anytime.

## Prerequisites

1. [Render account](https://dashboard.render.com/register)
2. [GitHub repo](https://github.com/Snehil208001/Ai-Expense-Tracker) with your code pushed

---

## Step 1: Push Code to GitHub

If your repo is empty, push your local project:

```bash
cd "c:\Expense Ai Tracker"
git init
git add .
git commit -m "Initial commit - AI Expense Tracker"
git branch -M main
git remote add origin https://github.com/Snehil208001/Ai-Expense-Tracker.git
git push -u origin main
```

---

## Step 2: Deploy via Render Blueprint

1. Go to [Render Dashboard](https://dashboard.render.com) → **Blueprints**
2. Click **New Blueprint Instance**
3. Connect your GitHub repo: `Snehil208001/Ai-Expense-Tracker`
4. Render will detect `render.yaml` and show:
   - **PostgreSQL** database (`expense-tracker-db`)
   - **Web Service** (`expense-tracker-api`)
5. Click **Apply**

---

## Step 3: Add Environment Variables

After the first deploy, add your **Google Gemini API key** (for AI features):

1. Go to your **Web Service** → **Environment**
2. Add:
   - `GOOGLE_GEMINI_API_KEY` = your [Gemini API key](https://aistudio.google.com/apikey)
3. **Save** (Render will redeploy)

> **JWT_SECRET** is auto-generated by Render. No action needed.

---

## Step 4: Get Your API URL

1. After deploy, open your **Web Service**
2. Copy the URL, e.g. `https://expense-tracker-api-xxxx.onrender.com`
3. Health check: `https://expense-tracker-api-xxxx.onrender.com/api/health`

---

## Step 5: Point Mobile App to Render

Edit `mobile-expo/src/config/api.ts`:

```typescript
const DEV_HOST = '192.168.1.8'; // Keep for local dev
export const API_BASE = __DEV__ 
  ? `http://${DEV_HOST}:3000` 
  : 'https://expense-tracker-api-xxxx.onrender.com';  // ← Your Render URL
```

Or use an env variable for production (recommended for different builds).

---

## Free Tier Notes

- **Web Service**: Spins down after 15 min of inactivity. First request may take 30–60s to wake.
- **PostgreSQL**: 1 GB storage, 90-day retention on free tier.
- **Gemini API**: Free tier has rate limits; get a key at [Google AI Studio](https://aistudio.google.com/apikey).

---

## Manual Deploy (without Blueprint)

If you prefer to set up manually:

1. **Create PostgreSQL**  
   Dashboard → New → PostgreSQL → Create

2. **Create Web Service**  
   Dashboard → New → Web Service → Connect repo

3. **Settings**:
   - **Root Directory**: `backend`
   - **Build Command**: `npm install && npx prisma generate && npm run build`
   - **Start Command**: `npx prisma migrate deploy && node dist/index.js`
   - **Environment**: Add `DATABASE_URL` (from PostgreSQL), `JWT_SECRET`, `GOOGLE_GEMINI_API_KEY`

---

## Troubleshooting

| Issue | Fix |
|-------|-----|
| Build fails on Prisma | Ensure `DATABASE_URL` is set before build. Use **Start Command** for migrations. |
| 503 on first request | Free tier cold start; wait 30–60s. |
| CORS errors | Backend uses `cors: { origin: true }`; should allow all origins. |
| AI features not working | Add `GOOGLE_GEMINI_API_KEY` in Environment. |
